<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>pm2 | 碌碌无为 🪂 知识整理</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/wwblog/img/favicon.ico">
    <link rel="stylesheet" href="/wwblog/iconfont/iconfont.css">
    <meta name="description" content="">
    <meta name="keywords" content="">
    
    <link rel="preload" href="/wwblog/assets/css/0.styles.6d915053.css" as="style"><link rel="preload" href="/wwblog/assets/js/app.0e0201b5.js" as="script"><link rel="preload" href="/wwblog/assets/js/3.e40f20a1.js" as="script"><link rel="preload" href="/wwblog/assets/js/1.6112db0e.js" as="script"><link rel="preload" href="/wwblog/assets/js/115.2eabd80f.js" as="script"><link rel="preload" href="/wwblog/assets/js/25.f1c8b165.js" as="script"><link rel="preload" href="/wwblog/assets/js/26.8d4e2030.js" as="script"><link rel="prefetch" href="/wwblog/assets/js/10.ead2052c.js"><link rel="prefetch" href="/wwblog/assets/js/100.8ebd083d.js"><link rel="prefetch" href="/wwblog/assets/js/101.1512be69.js"><link rel="prefetch" href="/wwblog/assets/js/102.1dd604e8.js"><link rel="prefetch" href="/wwblog/assets/js/103.0d2cafa6.js"><link rel="prefetch" href="/wwblog/assets/js/104.2fbbcdf2.js"><link rel="prefetch" href="/wwblog/assets/js/105.034503b5.js"><link rel="prefetch" href="/wwblog/assets/js/106.2377d717.js"><link rel="prefetch" href="/wwblog/assets/js/107.da24425a.js"><link rel="prefetch" href="/wwblog/assets/js/108.8f7a5a17.js"><link rel="prefetch" href="/wwblog/assets/js/109.dac394c5.js"><link rel="prefetch" href="/wwblog/assets/js/11.d6c70d56.js"><link rel="prefetch" href="/wwblog/assets/js/110.f3cc7f27.js"><link rel="prefetch" href="/wwblog/assets/js/111.1c9d4e37.js"><link rel="prefetch" href="/wwblog/assets/js/112.b55d2ee3.js"><link rel="prefetch" href="/wwblog/assets/js/113.bd64cbc8.js"><link rel="prefetch" href="/wwblog/assets/js/114.4e0db573.js"><link rel="prefetch" href="/wwblog/assets/js/116.c5fc07ab.js"><link rel="prefetch" href="/wwblog/assets/js/117.90ec6696.js"><link rel="prefetch" href="/wwblog/assets/js/118.0c9946b3.js"><link rel="prefetch" href="/wwblog/assets/js/119.8c93fe06.js"><link rel="prefetch" href="/wwblog/assets/js/12.03a87e33.js"><link rel="prefetch" href="/wwblog/assets/js/120.3488c313.js"><link rel="prefetch" href="/wwblog/assets/js/121.2ed19331.js"><link rel="prefetch" href="/wwblog/assets/js/122.6cf48a1b.js"><link rel="prefetch" href="/wwblog/assets/js/13.46bc3555.js"><link rel="prefetch" href="/wwblog/assets/js/14.2f0bfdcc.js"><link rel="prefetch" href="/wwblog/assets/js/15.4c613dd6.js"><link rel="prefetch" href="/wwblog/assets/js/16.cc9bbedd.js"><link rel="prefetch" href="/wwblog/assets/js/17.280dccef.js"><link rel="prefetch" href="/wwblog/assets/js/18.17de33cf.js"><link rel="prefetch" href="/wwblog/assets/js/19.da0ee97f.js"><link rel="prefetch" href="/wwblog/assets/js/2.ab0c2f02.js"><link rel="prefetch" href="/wwblog/assets/js/20.52f2efe6.js"><link rel="prefetch" href="/wwblog/assets/js/21.f7274164.js"><link rel="prefetch" href="/wwblog/assets/js/22.2ebcf1dc.js"><link rel="prefetch" href="/wwblog/assets/js/23.6815f8f2.js"><link rel="prefetch" href="/wwblog/assets/js/24.8a643cd0.js"><link rel="prefetch" href="/wwblog/assets/js/27.6883885e.js"><link rel="prefetch" href="/wwblog/assets/js/28.ddf9f934.js"><link rel="prefetch" href="/wwblog/assets/js/29.7322cfb8.js"><link rel="prefetch" href="/wwblog/assets/js/30.c5a1f2f8.js"><link rel="prefetch" href="/wwblog/assets/js/31.1702585e.js"><link rel="prefetch" href="/wwblog/assets/js/32.40241365.js"><link rel="prefetch" href="/wwblog/assets/js/33.8687ea63.js"><link rel="prefetch" href="/wwblog/assets/js/34.be20e881.js"><link rel="prefetch" href="/wwblog/assets/js/35.3e12cae0.js"><link rel="prefetch" href="/wwblog/assets/js/36.8852432d.js"><link rel="prefetch" href="/wwblog/assets/js/37.ea27a75a.js"><link rel="prefetch" href="/wwblog/assets/js/38.92b6828e.js"><link rel="prefetch" href="/wwblog/assets/js/39.78416700.js"><link rel="prefetch" href="/wwblog/assets/js/4.1fce4caa.js"><link rel="prefetch" href="/wwblog/assets/js/40.77a5df24.js"><link rel="prefetch" href="/wwblog/assets/js/41.891302ed.js"><link rel="prefetch" href="/wwblog/assets/js/42.cffd47b0.js"><link rel="prefetch" href="/wwblog/assets/js/43.146bf699.js"><link rel="prefetch" href="/wwblog/assets/js/44.e58b6960.js"><link rel="prefetch" href="/wwblog/assets/js/45.95dd3f6b.js"><link rel="prefetch" href="/wwblog/assets/js/46.ed3b9bab.js"><link rel="prefetch" href="/wwblog/assets/js/47.8799af3d.js"><link rel="prefetch" href="/wwblog/assets/js/48.ce6360bb.js"><link rel="prefetch" href="/wwblog/assets/js/49.5cadd6d1.js"><link rel="prefetch" href="/wwblog/assets/js/5.05f748ed.js"><link rel="prefetch" href="/wwblog/assets/js/50.a73e32f0.js"><link rel="prefetch" href="/wwblog/assets/js/51.7b6e4320.js"><link rel="prefetch" href="/wwblog/assets/js/52.7ae7c224.js"><link rel="prefetch" href="/wwblog/assets/js/53.aa62c86c.js"><link rel="prefetch" href="/wwblog/assets/js/54.84af44c7.js"><link rel="prefetch" href="/wwblog/assets/js/55.d06e043f.js"><link rel="prefetch" href="/wwblog/assets/js/56.ad75a58a.js"><link rel="prefetch" href="/wwblog/assets/js/57.6793b83d.js"><link rel="prefetch" href="/wwblog/assets/js/58.5ca646ac.js"><link rel="prefetch" href="/wwblog/assets/js/59.3e7735bc.js"><link rel="prefetch" href="/wwblog/assets/js/6.ececcadc.js"><link rel="prefetch" href="/wwblog/assets/js/60.f6b57a71.js"><link rel="prefetch" href="/wwblog/assets/js/61.0bc79206.js"><link rel="prefetch" href="/wwblog/assets/js/62.e9a8c735.js"><link rel="prefetch" href="/wwblog/assets/js/63.f57bd9f6.js"><link rel="prefetch" href="/wwblog/assets/js/64.d2ce549c.js"><link rel="prefetch" href="/wwblog/assets/js/65.e076c1d1.js"><link rel="prefetch" href="/wwblog/assets/js/66.1a736f60.js"><link rel="prefetch" href="/wwblog/assets/js/67.fe1bc553.js"><link rel="prefetch" href="/wwblog/assets/js/68.a218fa7b.js"><link rel="prefetch" href="/wwblog/assets/js/69.8c1eecc2.js"><link rel="prefetch" href="/wwblog/assets/js/7.7f333b20.js"><link rel="prefetch" href="/wwblog/assets/js/70.6d2d843c.js"><link rel="prefetch" href="/wwblog/assets/js/71.8c646a4e.js"><link rel="prefetch" href="/wwblog/assets/js/72.988bb703.js"><link rel="prefetch" href="/wwblog/assets/js/73.76e5cdeb.js"><link rel="prefetch" href="/wwblog/assets/js/74.ea7799ad.js"><link rel="prefetch" href="/wwblog/assets/js/75.4098c5e4.js"><link rel="prefetch" href="/wwblog/assets/js/76.5622a084.js"><link rel="prefetch" href="/wwblog/assets/js/77.73a7c5f9.js"><link rel="prefetch" href="/wwblog/assets/js/78.23a1d70a.js"><link rel="prefetch" href="/wwblog/assets/js/79.41179bb5.js"><link rel="prefetch" href="/wwblog/assets/js/80.39a49167.js"><link rel="prefetch" href="/wwblog/assets/js/81.9caefc31.js"><link rel="prefetch" href="/wwblog/assets/js/82.52a0fa2e.js"><link rel="prefetch" href="/wwblog/assets/js/83.74b297fd.js"><link rel="prefetch" href="/wwblog/assets/js/84.4553b153.js"><link rel="prefetch" href="/wwblog/assets/js/85.6ab6f74c.js"><link rel="prefetch" href="/wwblog/assets/js/86.0df5ee36.js"><link rel="prefetch" href="/wwblog/assets/js/87.8b329d5e.js"><link rel="prefetch" href="/wwblog/assets/js/88.cb074483.js"><link rel="prefetch" href="/wwblog/assets/js/89.292c5129.js"><link rel="prefetch" href="/wwblog/assets/js/90.9ef31f3a.js"><link rel="prefetch" href="/wwblog/assets/js/91.f9264fdb.js"><link rel="prefetch" href="/wwblog/assets/js/92.a2300a67.js"><link rel="prefetch" href="/wwblog/assets/js/93.95ac6166.js"><link rel="prefetch" href="/wwblog/assets/js/94.1fbab311.js"><link rel="prefetch" href="/wwblog/assets/js/95.3baa307a.js"><link rel="prefetch" href="/wwblog/assets/js/96.25650bf1.js"><link rel="prefetch" href="/wwblog/assets/js/97.0ee7e940.js"><link rel="prefetch" href="/wwblog/assets/js/98.4713ebb1.js"><link rel="prefetch" href="/wwblog/assets/js/99.cdeadc41.js"><link rel="prefetch" href="/wwblog/assets/js/vendors~docsearch.9fd01095.js">
    <link rel="stylesheet" href="/wwblog/assets/css/0.styles.6d915053.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wwblog/" class="home-link router-link-active"><img src="/wwblog/img/leftLogo.ico" alt="碌碌无为 🪂 知识整理" class="logo"> <span class="site-name can-hide">碌碌无为 🪂 知识整理</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/wwblog/" class="nav-link">🔥 首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🚀 前端" class="dropdown-title"><a href="/wwblog/pages/73309c/" class="link-title">🚀 前端</a> <span class="title" style="display:none;">🚀 前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wwblog/pages/73309c/" class="nav-link">Html</a></li><li class="dropdown-subitem"><a href="/wwblog/pages/ed3de1/" class="nav-link">Css</a></li><li class="dropdown-subitem"><a href="/wwblog/pages/738fa3/" class="nav-link">Less</a></li><li class="dropdown-subitem"><a href="/wwblog/pages/227687/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/wwblog/pages/d0f169/" class="nav-link">TypeScript</a></li></ul></li><li class="dropdown-item"><h4>框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wwblog/pages/44307d/" class="nav-link">Vue</a></li><li class="dropdown-subitem"><a href="/wwblog/pages/087eee/" class="nav-link">Pinia</a></li><li class="dropdown-subitem"><a href="/wwblog/pages/b2b4ce/" class="nav-link">Vite</a></li><li class="dropdown-subitem"><a href="/wwblog/pages/0f8172/" class="nav-link">Webpack</a></li></ul></li><li class="dropdown-item"><h4>小程序</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wwblog/pages/56b587/" class="nav-link">原生小程序</a></li><li class="dropdown-subitem"><a href="/wwblog/pages/dace69/" class="nav-link">Taro多端</a></li></ul></li><li class="dropdown-item"><h4>跨平台</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wwblog/pages/1c2e60/" class="nav-link">Electron 🕳️</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="📗 Node" class="dropdown-title"><a href="/wwblog/pages/fa5d34/" class="link-title">📗 Node</a> <span class="title" style="display:none;">📗 Node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/wwblog/pages/fa5d34/" class="nav-link">📖 Koa</a></li><li class="dropdown-item"><!----> <a href="/wwblog/pages/3a1aae/" class="nav-link">📖 Express</a></li><li class="dropdown-item"><!----> <a href="/wwblog/pages/4fff19/" class="nav-link">📖 MySQL</a></li><li class="dropdown-item"><!----> <a href="/wwblog/pages/001c58/" aria-current="page" class="nav-link router-link-exact-active router-link-active">📖 Package</a></li></ul></div></div><div class="nav-item"><a href="/wwblog/pages/0a6cce/" class="nav-link">📘 Git</a></div><div class="nav-item"><a href="/wwblog/pages/5af5f1/" class="nav-link">📒 面试题</a></div><div class="nav-item"><a href="/wwblog/pages/900797/" class="nav-link">📙 资源链接</a></div> <a href="https://github.com/MX-lbw/vuepressBlog" target="_blank" title="GitHub" rel="noopener noreferrer" class="repo-link"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24" data-v-6163be0c><path d="M5.883 18.653c-.3-.2-.558-.455-.86-.816a50.32 50.32 0 0 1-.466-.579c-.463-.575-.755-.84-1.057-.949a1 1 0 0 1 .676-1.883c.752.27 1.261.735 1.947 1.588c-.094-.117.34.427.433.539c.19.227.33.365.44.438c.204.137.587.196 1.15.14c.023-.382.094-.753.202-1.095C5.38 15.31 3.7 13.396 3.7 9.64c0-1.24.37-2.356 1.058-3.292c-.218-.894-.185-1.975.302-3.192a1 1 0 0 1 .63-.582c.081-.024.127-.035.208-.047c.803-.123 1.937.17 3.415 1.096A11.731 11.731 0 0 1 12 3.315c.912 0 1.818.104 2.684.308c1.477-.933 2.613-1.226 3.422-1.096c.085.013.157.03.218.05a1 1 0 0 1 .616.58c.487 1.216.52 2.297.302 3.19c.691.936 1.058 2.045 1.058 3.293c0 3.757-1.674 5.665-4.642 6.392c.125.415.19.879.19 1.38a300.492 300.492 0 0 1-.012 2.716a1 1 0 0 1-.019 1.958c-1.139.228-1.983-.532-1.983-1.525l.002-.446l.005-.705c.005-.708.007-1.338.007-1.998c0-.697-.183-1.152-.425-1.36c-.661-.57-.326-1.655.54-1.752c2.967-.333 4.337-1.482 4.337-4.66c0-.955-.312-1.744-.913-2.404a1 1 0 0 1-.19-1.045c.166-.414.237-.957.096-1.614l-.01.003c-.491.139-1.11.44-1.858.949a1 1 0 0 1-.833.135A9.626 9.626 0 0 0 12 5.315c-.89 0-1.772.119-2.592.35a1 1 0 0 1-.83-.134c-.752-.507-1.374-.807-1.868-.947c-.144.653-.073 1.194.092 1.607a1 1 0 0 1-.189 1.045C6.016 7.89 5.7 8.694 5.7 9.64c0 3.172 1.371 4.328 4.322 4.66c.865.097 1.201 1.177.544 1.748c-.192.168-.429.732-.429 1.364v3.15c0 .986-.835 1.725-1.96 1.528a1 1 0 0 1-.04-1.962v-.99c-.91.061-1.662-.088-2.254-.485z" fill="currentColor"></path></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/wwblog/" class="nav-link">🔥 首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🚀 前端" class="dropdown-title"><a href="/wwblog/pages/73309c/" class="link-title">🚀 前端</a> <span class="title" style="display:none;">🚀 前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wwblog/pages/73309c/" class="nav-link">Html</a></li><li class="dropdown-subitem"><a href="/wwblog/pages/ed3de1/" class="nav-link">Css</a></li><li class="dropdown-subitem"><a href="/wwblog/pages/738fa3/" class="nav-link">Less</a></li><li class="dropdown-subitem"><a href="/wwblog/pages/227687/" class="nav-link">JavaScript</a></li><li class="dropdown-subitem"><a href="/wwblog/pages/d0f169/" class="nav-link">TypeScript</a></li></ul></li><li class="dropdown-item"><h4>框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wwblog/pages/44307d/" class="nav-link">Vue</a></li><li class="dropdown-subitem"><a href="/wwblog/pages/087eee/" class="nav-link">Pinia</a></li><li class="dropdown-subitem"><a href="/wwblog/pages/b2b4ce/" class="nav-link">Vite</a></li><li class="dropdown-subitem"><a href="/wwblog/pages/0f8172/" class="nav-link">Webpack</a></li></ul></li><li class="dropdown-item"><h4>小程序</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wwblog/pages/56b587/" class="nav-link">原生小程序</a></li><li class="dropdown-subitem"><a href="/wwblog/pages/dace69/" class="nav-link">Taro多端</a></li></ul></li><li class="dropdown-item"><h4>跨平台</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/wwblog/pages/1c2e60/" class="nav-link">Electron 🕳️</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="📗 Node" class="dropdown-title"><a href="/wwblog/pages/fa5d34/" class="link-title">📗 Node</a> <span class="title" style="display:none;">📗 Node</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/wwblog/pages/fa5d34/" class="nav-link">📖 Koa</a></li><li class="dropdown-item"><!----> <a href="/wwblog/pages/3a1aae/" class="nav-link">📖 Express</a></li><li class="dropdown-item"><!----> <a href="/wwblog/pages/4fff19/" class="nav-link">📖 MySQL</a></li><li class="dropdown-item"><!----> <a href="/wwblog/pages/001c58/" aria-current="page" class="nav-link router-link-exact-active router-link-active">📖 Package</a></li></ul></div></div><div class="nav-item"><a href="/wwblog/pages/0a6cce/" class="nav-link">📘 Git</a></div><div class="nav-item"><a href="/wwblog/pages/5af5f1/" class="nav-link">📒 面试题</a></div><div class="nav-item"><a href="/wwblog/pages/900797/" class="nav-link">📙 资源链接</a></div> <a href="https://github.com/MX-lbw/vuepressBlog" target="_blank" title="GitHub" rel="noopener noreferrer" class="repo-link"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1.2em" height="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24" data-v-6163be0c><path d="M5.883 18.653c-.3-.2-.558-.455-.86-.816a50.32 50.32 0 0 1-.466-.579c-.463-.575-.755-.84-1.057-.949a1 1 0 0 1 .676-1.883c.752.27 1.261.735 1.947 1.588c-.094-.117.34.427.433.539c.19.227.33.365.44.438c.204.137.587.196 1.15.14c.023-.382.094-.753.202-1.095C5.38 15.31 3.7 13.396 3.7 9.64c0-1.24.37-2.356 1.058-3.292c-.218-.894-.185-1.975.302-3.192a1 1 0 0 1 .63-.582c.081-.024.127-.035.208-.047c.803-.123 1.937.17 3.415 1.096A11.731 11.731 0 0 1 12 3.315c.912 0 1.818.104 2.684.308c1.477-.933 2.613-1.226 3.422-1.096c.085.013.157.03.218.05a1 1 0 0 1 .616.58c.487 1.216.52 2.297.302 3.19c.691.936 1.058 2.045 1.058 3.293c0 3.757-1.674 5.665-4.642 6.392c.125.415.19.879.19 1.38a300.492 300.492 0 0 1-.012 2.716a1 1 0 0 1-.019 1.958c-1.139.228-1.983-.532-1.983-1.525l.002-.446l.005-.705c.005-.708.007-1.338.007-1.998c0-.697-.183-1.152-.425-1.36c-.661-.57-.326-1.655.54-1.752c2.967-.333 4.337-1.482 4.337-4.66c0-.955-.312-1.744-.913-2.404a1 1 0 0 1-.19-1.045c.166-.414.237-.957.096-1.614l-.01.003c-.491.139-1.11.44-1.858.949a1 1 0 0 1-.833.135A9.626 9.626 0 0 0 12 5.315c-.89 0-1.772.119-2.592.35a1 1 0 0 1-.83-.134c-.752-.507-1.374-.807-1.868-.947c-.144.653-.073 1.194.092 1.607a1 1 0 0 1-.189 1.045C6.016 7.89 5.7 8.694 5.7 9.64c0 3.172 1.371 4.328 4.322 4.66c.865.097 1.201 1.177.544 1.748c-.192.168-.429.732-.429 1.364v3.15c0 .986-.835 1.725-1.96 1.528a1 1 0 0 1-.04-1.962v-.99c-.91.061-1.662-.088-2.254-.485z" fill="currentColor"></path></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>内置模块</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wwblog/pages/1b0e07/" class="sidebar-link">Nodejs核心模块</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Koa</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wwblog/pages/fa5d34/" class="sidebar-link">Koa</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Express</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wwblog/pages/3a1aae/" class="sidebar-link">express</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Mysql</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wwblog/pages/4fff19/" class="sidebar-link">Mysql</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>package</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wwblog/pages/001c58/" aria-current="page" class="active sidebar-link">pm2</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/wwblog/pages/001c58/#安装-pm2" class="sidebar-link">安装 PM2</a></li><li class="sidebar-sub-header level2"><a href="/wwblog/pages/001c58/#启动一个应用程序" class="sidebar-link">启动一个应用程序</a></li><li class="sidebar-sub-header level2"><a href="/wwblog/pages/001c58/#更新-pm2" class="sidebar-link">更新 PM2</a></li><li class="sidebar-sub-header level2"><a href="/wwblog/pages/001c58/#目录介绍" class="sidebar-link">目录介绍</a></li><li class="sidebar-sub-header level2"><a href="/wwblog/pages/001c58/#入门教程" class="sidebar-link">入门教程</a></li><li class="sidebar-sub-header level2"><a href="/wwblog/pages/001c58/#常用命令" class="sidebar-link">常用命令</a></li><li class="sidebar-sub-header level2"><a href="/wwblog/pages/001c58/#配置文件" class="sidebar-link">配置文件</a></li><li class="sidebar-sub-header level2"><a href="/wwblog/pages/001c58/#自动重启" class="sidebar-link">自动重启</a></li><li class="sidebar-sub-header level2"><a href="/wwblog/pages/001c58/#环境切换" class="sidebar-link">环境切换</a></li><li class="sidebar-sub-header level2"><a href="/wwblog/pages/001c58/#负载均衡" class="sidebar-link">负载均衡</a></li><li class="sidebar-sub-header level2"><a href="/wwblog/pages/001c58/#日志查看" class="sidebar-link">日志查看</a></li><li class="sidebar-sub-header level2"><a href="/wwblog/pages/001c58/#指令-tab-补全" class="sidebar-link">指令 tab 补全</a></li><li class="sidebar-sub-header level2"><a href="/wwblog/pages/001c58/#开机自动启动" class="sidebar-link">开机自动启动</a></li><li class="sidebar-sub-header level2"><a href="/wwblog/pages/001c58/#传入-node-args" class="sidebar-link">传入 node args</a></li><li class="sidebar-sub-header level2"><a href="/wwblog/pages/001c58/#监控-monitor" class="sidebar-link">监控(monitor)</a></li><li class="sidebar-sub-header level2"><a href="/wwblog/pages/001c58/#内存使用超过上限自动重启" class="sidebar-link">内存使用超过上限自动重启</a></li><li class="sidebar-sub-header level2"><a href="/wwblog/pages/001c58/#模块系统-module-system" class="sidebar-link">模块系统 Module system</a></li></ul></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-f8b55ed6><div class="articleInfo" data-v-f8b55ed6><ul class="breadcrumbs" data-v-f8b55ed6><li data-v-f8b55ed6><a href="/wwblog/" title="首页" class="iconfont icon-home router-link-active" data-v-f8b55ed6></a></li> <li data-v-f8b55ed6><span data-v-f8b55ed6>package</span></li> <!----></ul> <div class="info" data-v-f8b55ed6><div title="作者" class="author iconfont icon-touxiang" data-v-f8b55ed6><a href="https://github.com/MX-lbw" target="_blank" title="作者" class="beLink" data-v-f8b55ed6>wuwei</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-f8b55ed6><a href="javascript:;" data-v-f8b55ed6>2023-04-20</a></div> <div class="page-view" style="margin-left:0;" data-v-47d906e8 data-v-f8b55ed6><div title="文章字数" class="book-words iconfont icon-book" data-v-47d906e8><a href="javascript:;" style="margin-left: 3px; color: #888" data-v-47d906e8>0</a></div> <!----> <div title="浏览量" class="page-view iconfont icon-view" data-v-47d906e8><a href="javascript:;" id="busuanzi_value_page_pv" class="view-data" style="color: #888; margin-left: 3px" data-v-47d906e8><i title="正在获取..." class="loading iconfont icon-loading" data-v-47d906e8></i></a></div></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">pm2<!----></h1> <!----> <div class="theme-vdoing-content content__default"><p>PM2 是 node 进程管理工具，可以利用它来简化很多 node 应用管理的繁琐任务，如性能监控、自动重启、负载均衡等，而且使用非常简单。
下面就对 PM2 进行入门性的介绍，基本涵盖了 PM2 的常用的功能和配置</p> <h2 id="安装-pm2"><a href="#安装-pm2" class="header-anchor">#</a> 安装 PM2</h2> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ npm install pm2 <span class="token operator">-</span>g
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="启动一个应用程序"><a href="#启动一个应用程序" class="header-anchor">#</a> 启动一个应用程序</h2> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ pm2 start app<span class="token punctuation">.</span>js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="更新-pm2"><a href="#更新-pm2" class="header-anchor">#</a> 更新 PM2</h2> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code><span class="token comment"># 安装最新的pm2</span>
$ pm2 save <span class="token comment"># 记得保存进程状态</span>
$ npm install pm2 <span class="token operator">-</span>g
$ pm2 update
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="目录介绍"><a href="#目录介绍" class="header-anchor">#</a> 目录介绍</h2> <p>pm2 安装好后，会自动创建下面目录。看文件名基本就知道干嘛的了，就不翻译了。</p> <ul><li><code>$HOME/.pm2</code> will contain all PM2 related files</li> <li><code>$HOME/.pm2/logs</code> will contain all applications logs</li> <li><code>$HOME/.pm2/pids</code> will contain all applications pids</li> <li><code>$HOME/.pm2/pm2.log</code> PM2 logs</li> <li><code>$HOME/.pm2/pm2.pid</code> PM2 pid</li> <li><code>$HOME/.pm2/rpc.sock</code> Socket file for remote commands</li> <li><code>$HOME/.pm2/pub.sock</code> Socket file for publishable events</li> <li><code>$HOME/.pm2/conf.js</code> PM2 Configuration</li></ul> <h2 id="入门教程"><a href="#入门教程" class="header-anchor">#</a> 入门教程</h2> <p>一般我们都是通过<code>npm start</code>启动应用，其实就是调用<code>node ./bin/www</code>。那么，换成 pm2 就是</p> <p>注意，这里用了<code>--watch</code>参数，意味着当你的 express 应用代码发生变化时，pm2 会帮你重启服务，多贴心。</p> <div class="language-undefined line-numbers-mode"><pre class="language-text"><code>pm2 start ./bin/www --watch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>官方文档：<code>http://pm2.keymetrics.io/docs/usage/quick-start](https://links.jianshu.com/go?to=http%3A%2F%2Fpm2.keymetrics.io%2Fdocs%2Fusage%2Fquick-start</code></p> <h2 id="常用命令"><a href="#常用命令" class="header-anchor">#</a> 常用命令</h2> <h3 id="启动"><a href="#启动" class="header-anchor">#</a> 启动</h3> <p>参数说明：</p> <ul><li><code>--watch</code>：监听应用目录的变化，一旦发生变化，自动重启。如果要精确监听、不见听的目录，最好通过配置文件。</li> <li><code>-i --instances</code>：启用多少个实例，可用于负载均衡。如果<code>-i 0</code>或者<code>-i max</code>，则根据当前机器核数确定实例数目。</li> <li><code>--ignore-watch</code>：排除监听的目录/文件，可以是特定的文件名，也可以是正则。比如<code>--ignore-watch=&quot;test node_modules &quot;some scripts&quot;&quot;</code></li> <li><code>-n --name</code>：应用的名称。查看应用信息的时候可以用到。</li> <li><code>-o --output &lt;path&gt;</code>：标准输出日志文件的路径。</li> <li><code>-e --error &lt;path&gt;</code>：错误输出日志文件的路径。</li> <li><code>--interpreter &lt;interpreter&gt;</code>：the interpreter pm2 should use for executing app (bash, python...)。比如你用的 coffee script 来编写应用。</li></ul> <p>完整命令行参数列表：<a href="https://links.jianshu.com/go?to=http%3A%2F%2Fpm2.keymetrics.io%2Fdocs%2Fusage%2Fquick-start%2F%23options" target="_blank" rel="noopener noreferrer">地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-css line-numbers-mode"><pre class="language-css"><code>pm2 start app.js --watch -i 2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="重启"><a href="#重启" class="header-anchor">#</a> 重启</h3> <div class="language-css line-numbers-mode"><pre class="language-css"><code>pm2 restart app.js
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="停止"><a href="#停止" class="header-anchor">#</a> 停止</h3> <p>停止特定的应用。可以先通过<code>pm2 list</code>获取应用的名字（--name 指定的）或者进程 id。</p> <div class="language-undefined line-numbers-mode"><pre class="language-text"><code>pm2 stop app_name|app_id
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果要停止所有应用，可以</p> <div class="language-undefined line-numbers-mode"><pre class="language-text"><code>pm2 stop all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="删除"><a href="#删除" class="header-anchor">#</a> 删除</h3> <p>类似<code>pm2 stop</code>，如下</p> <div class="language-undefined line-numbers-mode"><pre class="language-text"><code>pm2 stop app_name|app_id
pm2 stop all
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="查看进程状态"><a href="#查看进程状态" class="header-anchor">#</a> 查看进程状态</h3> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>pm2 list
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="查看某个进程的信息"><a href="#查看某个进程的信息" class="header-anchor">#</a> 查看某个进程的信息</h3> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token punctuation">[</span><span class="token label symbol">root@</span>iZ94wb7tioqZ pids<span class="token punctuation">]</span># pm2 describe <span class="token number">0</span>
Describing process with id <span class="token number">0</span> <span class="token operator">-</span> name oc<span class="token operator">-</span>server
┌───────────────────┬──────────────────────────────────────────────────────────────┐
│ status            │ online                                                       │
│ name              │ oc<span class="token operator">-</span>server                                                    │
│ id                │ <span class="token number">0</span>                                                            │
│ path              │ <span class="token operator">/</span><span class="token keyword">data</span><span class="token operator">/</span>file<span class="token operator">/</span>qiquan<span class="token operator">/</span>over_the_counter<span class="token operator">/</span>server<span class="token operator">/</span>bin<span class="token operator">/</span>www            │
│ args              │                                                              │
│ exec cwd          │ <span class="token operator">/</span><span class="token keyword">data</span><span class="token operator">/</span>file<span class="token operator">/</span>qiquan<span class="token operator">/</span>over_the_counter<span class="token operator">/</span>server                    │
│ error log path    │ <span class="token operator">/</span><span class="token keyword">data</span><span class="token operator">/</span>file<span class="token operator">/</span>qiquan<span class="token operator">/</span>over_the_counter<span class="token operator">/</span>server<span class="token operator">/</span>logs<span class="token operator">/</span>app<span class="token operator">-</span>err<span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">.</span>log │
│ <span class="token keyword">out</span> log path      │ <span class="token operator">/</span><span class="token keyword">data</span><span class="token operator">/</span>file<span class="token operator">/</span>qiquan<span class="token operator">/</span>over_the_counter<span class="token operator">/</span>server<span class="token operator">/</span>logs<span class="token operator">/</span>app<span class="token operator">-</span><span class="token keyword">out</span><span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">.</span>log │
│ pid path          │ <span class="token operator">/</span>root<span class="token operator">/</span><span class="token punctuation">.</span>pm2<span class="token operator">/</span>pids<span class="token operator">/</span>oc<span class="token operator">-</span>server<span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">.</span>pid                              │
│ mode              │ fork_mode                                                    │
│ node v8 arguments │                                                              │
│ watch &amp; reload    │                                                              │
│ interpreter       │ node                                                         │
│ restarts          │ <span class="token number">293</span>                                                          │
│ unstable restarts │ <span class="token number">0</span>                                                            │
│ uptime            │ 87m                                                          │
│ created at        │ <span class="token number">2016</span><span class="token operator">-</span><span class="token number">08</span><span class="token operator">-</span>26T08<span class="token operator">:</span><span class="token number">13</span><span class="token operator">:</span><span class="token number">43</span><span class="token punctuation">.</span>705Z                                     │
└───────────────────┴──────────────────────────────────────────────────────────────┘
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h2 id="配置文件"><a href="#配置文件" class="header-anchor">#</a> 配置文件</h2> <h3 id="简单说明"><a href="#简单说明" class="header-anchor">#</a> 简单说明</h3> <ul><li>配置文件里的设置项，跟命令行参数基本是一一对应的。</li> <li>可以选择<code>yaml</code>或者<code>json</code>文件，就看个人洗好了。</li> <li><code>json</code>格式的配置文件，pm2 当作普通的 js 文件来处理，所以可以在里面添加注释或者编写代码，这对于动态调整配置很有好处。</li> <li>如果启动的时候指定了配置文件，那么命令行参数会被忽略。（个别参数除外，比如--env）</li></ul> <h3 id="例子"><a href="#例子" class="header-anchor">#</a> 例子</h3> <p>举个简单例子，完整配置说明请参考<a href="https://links.jianshu.com/go?to=http%3A%2F%2Fpm2.keymetrics.io%2Fdocs%2Fusage%2Fpm2-doc-single-page%2F" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;fis-receiver&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 应用名称</span>
  <span class="token property">&quot;script&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./bin/www&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 实际启动脚本</span>
  <span class="token property">&quot;cwd&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 当前工作路径</span>
  <span class="token property">&quot;watch&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 监控变化的目录，一旦变化，自动重启</span>
    <span class="token string">&quot;bin&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;routers&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;ignore_watch&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// 从监控目录中排除</span>
    <span class="token string">&quot;node_modules&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;logs&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;public&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;watch_options&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;followSymlinks&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;error_file&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./logs/app-err.log&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 错误日志路径</span>
  <span class="token property">&quot;out_file&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./logs/app-out.log&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 普通日志路径</span>
  <span class="token property">&quot;env&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;NODE_ENV&quot;</span><span class="token operator">:</span> <span class="token string">&quot;production&quot;</span> <span class="token comment">// 环境参数，当前指定为生产环境</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="自动重启"><a href="#自动重启" class="header-anchor">#</a> 自动重启</h2> <p>前面已经提到了，这里贴命令行，更多点击<a href="https://links.jianshu.com/go?to=http%3A%2F%2Fpm2.keymetrics.io%2Fdocs%2Fusage%2Fwatch-and-restart%2F%23auto-restart-apps-on-file-change" target="_blank" rel="noopener noreferrer">这里<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code>pm2 start app.js --watch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这里是监控整个项目的文件，如果只想监听指定文件和目录，建议通过配置文件的<code>watch</code>、<code>ignore_watch</code>字段来设置。</p> <h2 id="环境切换"><a href="#环境切换" class="header-anchor">#</a> 环境切换</h2> <p>在实际项目开发中，我们的应用经常需要在多个环境下部署，比如开发环境、测试环境、生产环境等。在不同环境下，有时候配置项会有差异，比如链接的数据库地址不同等。</p> <p>对于这种场景，pm2 也是可以很好支持的。首先通过在配置文件中通过<code>env_xx</code>来声明不同环境的配置，然后在启动应用时，通过<code>--env</code>参数指定运行的环境。</p> <h3 id="环境配置声明"><a href="#环境配置声明" class="header-anchor">#</a> 环境配置声明</h3> <p>首先，在配置文件中，通过<code>env</code>选项声明多个环境配置。简单说明下：</p> <ul><li><code>env</code>为默认的环境配置（生产环境），<code>env_dev</code>、<code>env_test</code>则分别是开发、测试环境。可以看到，不同环境下的<code>NODE_ENV</code>、<code>REMOTE_ADDR</code>字段的值是不同的。</li> <li>在应用中，可以通过<code>process.env.REMOTE_ADDR</code>等来读取配置中生命的变量。</li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>  <span class="token string">&quot;env&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;NODE_ENV&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;production&quot;</span>,
    <span class="token string">&quot;REMOTE_ADDR&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;http://www.example.com/&quot;</span>
  <span class="token punctuation">}</span>,
  <span class="token string">&quot;env_dev&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;NODE_ENV&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;development&quot;</span>,
    <span class="token string">&quot;REMOTE_ADDR&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;http://wdev.example.com/&quot;</span>
  <span class="token punctuation">}</span>,
  <span class="token string">&quot;env_test&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;NODE_ENV&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;test&quot;</span>,
    <span class="token string">&quot;REMOTE_ADDR&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;http://wtest.example.com/&quot;</span>
  <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="启动指明环境"><a href="#启动指明环境" class="header-anchor">#</a> 启动指明环境</h3> <p>假设通过下面启动脚本（开发环境），那么，此时<code>process.env.REMOTE_ADDR</code>的值就是相应的 <a href="https://links.jianshu.com/go?to=http%3A%2F%2Fwdev.example.com%2F" target="_blank" rel="noopener noreferrer">http://wdev.example.com/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ，可以自己试验下。</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code>pm2 start app.js --env dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="负载均衡"><a href="#负载均衡" class="header-anchor">#</a> 负载均衡</h2> <p>命令如下，表示开启三个进程。如果<code>-i 0</code>，则会根据机器当前核数自动开启尽可能多的进程。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>pm2 start app.js <span class="token parameter variable">-i</span> <span class="token number">3</span> <span class="token comment"># 开启三个进程</span>
pm2 start app.js <span class="token parameter variable">-i</span> max <span class="token comment"># 根据机器CPU核数，开启对应数目的进程</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>参考文档：<a href="https://links.jianshu.com/go?to=http%3A%2F%2Fpm2.keymetrics.io%2Fdocs%2Fusage%2Fcluster-mode%2F%23automatic-load-balancing" target="_blank" rel="noopener noreferrer">点击查看<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="日志查看"><a href="#日志查看" class="header-anchor">#</a> 日志查看</h2> <p>除了可以打开日志文件查看日志外，还可以通过<code>pm2 logs</code>来查看实时日志。这点对于线上问题排查非常重要。</p> <p>比如某个 node 服务突然异常重启了，那么可以通过 pm2 提供的日志工具来查看实时日志，看是不是脚本出错之类导致的异常重启。</p> <div class="language-undefined line-numbers-mode"><pre class="language-text"><code>pm2 logs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="指令-tab-补全"><a href="#指令-tab-补全" class="header-anchor">#</a> 指令 tab 补全</h2> <p>运行<code>pm2 --help</code>，可以看到<code>pm2</code>支持的子命令还是蛮多的，这个时候，自动完成的功能就很重要了。</p> <p>运行如下命令。恭喜，已经能够通过 tab 自动补全了。细节可参考<a href="https://links.jianshu.com/go?to=http%3A%2F%2Fpm2.keymetrics.io%2Fdocs%2Fusage%2Fauto-completion%2F" target="_blank" rel="noopener noreferrer">这里<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>pm2 completion <span class="token function">install</span>
<span class="token builtin class-name">source</span> ~/.bash_profile
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="开机自动启动"><a href="#开机自动启动" class="header-anchor">#</a> 开机自动启动</h2> <p>可以通过<code>pm2 startup</code>来实现开机自启动。细节可<a href="https://links.jianshu.com/go?to=http%3A%2F%2Fpm2.keymetrics.io%2Fdocs%2Fusage%2Fstartup%2F" target="_blank" rel="noopener noreferrer">参考<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。大致流程如下</p> <ol><li>通过<code>pm2 save</code>保存当前进程状态。</li> <li>通过<code>pm2 startup [platform]</code>生成开机自启动的命令。（记得查看控制台输出）</li> <li>将步骤 2 生成的命令，粘贴到控制台进行，搞定。</li></ol> <h2 id="传入-node-args"><a href="#传入-node-args" class="header-anchor">#</a> 传入 node args</h2> <p>直接上例子，分别是通过命令行和配置文件。</p> <p>命令行：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>pm2 start app.js --node-args<span class="token operator">=</span><span class="token string">&quot;--harmony&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>配置文件：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;oc-server&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;script&quot;</span><span class="token operator">:</span> <span class="token string">&quot;app.js&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;node_args&quot;</span><span class="token operator">:</span> <span class="token string">&quot;--harmony&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="实例说明"><a href="#实例说明" class="header-anchor">#</a> 实例说明</h3> <p>假设是在<code>centos</code>下，那么运行如下命令，搞定。强烈建议运行完成之后，重启机器，看是否设置成功。</p> <div class="language-csharp line-numbers-mode"><pre class="language-csharp"><code><span class="token punctuation">[</span>root<span class="token class-name">@iZ94wb7tioqZ</span> option_analysis<span class="token punctuation">]</span># pm2 save
<span class="token punctuation">[</span>root<span class="token class-name">@iZ94wb7tioqZ</span> option_analysis<span class="token punctuation">]</span># pm2 startup centos
<span class="token punctuation">[</span>PM2<span class="token punctuation">]</span> Generating system <span class="token class-name">init</span> script <span class="token keyword">in</span> <span class="token operator">/</span>etc<span class="token operator">/</span>init<span class="token punctuation">.</span>d<span class="token operator">/</span>pm2<span class="token operator">-</span>init<span class="token punctuation">.</span>sh
<span class="token punctuation">[</span>PM2<span class="token punctuation">]</span> Making script booting at startup<span class="token range operator">..</span><span class="token punctuation">.</span>
<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">PM2</span></span><span class="token punctuation">]</span> <span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span><span class="token keyword">lock</span><span class="token operator">/</span>subsys<span class="token operator">/</span>pm2<span class="token operator">-</span>init<span class="token punctuation">.</span>sh lockfile has been added
<span class="token punctuation">[</span>PM2<span class="token punctuation">]</span> <span class="token operator">-</span>centos<span class="token operator">-</span> Using <span class="token class-name">the</span> command<span class="token punctuation">:</span>
      su <span class="token operator">-</span>c <span class="token string">&quot;chmod +x /etc/init.d/pm2-init.sh; chkconfig --add pm2-init.sh&quot;</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token class-name">PM2</span></span><span class="token punctuation">]</span> Done<span class="token punctuation">.</span>
<span class="token punctuation">[</span>root<span class="token class-name">@iZ94wb7tioqZ</span> option_analysis<span class="token punctuation">]</span># pm2 save
<span class="token punctuation">[</span>PM2<span class="token punctuation">]</span> Dumping processes
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="监控-monitor"><a href="#监控-monitor" class="header-anchor">#</a> 监控(monitor)</h2> <p>运行如下命令，查看当前通过 pm2 运行的进程的状态。</p> <div class="language-undefined line-numbers-mode"><pre class="language-text"><code>pm2 monit
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>看到类似输出</p> <div class="language-kotlin line-numbers-mode"><pre class="language-kotlin"><code><span class="token punctuation">[</span><span class="token label symbol">root@</span>oneday<span class="token operator">-</span>dev0 server<span class="token punctuation">]</span># pm2 monit
⌬ PM2 <span class="token function">monitoring</span> <span class="token punctuation">(</span>To go further check <span class="token keyword">out</span> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>app<span class="token punctuation">.</span>keymetrics<span class="token punctuation">.</span>io<span class="token punctuation">)</span>
                                       <span class="token punctuation">[</span>                              <span class="token punctuation">]</span> <span class="token number">0</span> <span class="token operator">%</span>
⌬ PM2 <span class="token function">monitoring</span> <span class="token punctuation">(</span>To go further check o<span class="token punctuation">[</span><span class="token operator">||</span><span class="token operator">||</span><span class="token operator">||</span><span class="token operator">||</span><span class="token operator">||</span><span class="token operator">||</span><span class="token operator">||</span>|               <span class="token punctuation">]</span> <span class="token number">196.285</span> MB

 ● fis<span class="token operator">-</span>receiver                        <span class="token punctuation">[</span>                              <span class="token punctuation">]</span> <span class="token number">0</span> <span class="token operator">%</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>fork_mode<span class="token punctuation">]</span>                        <span class="token punctuation">[</span><span class="token operator">||</span><span class="token operator">||</span>|                         <span class="token punctuation">]</span> <span class="token number">65.773</span> MB

 ● www                                 <span class="token punctuation">[</span>                              <span class="token punctuation">]</span> <span class="token number">0</span> <span class="token operator">%</span>
<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>fork_mode<span class="token punctuation">]</span>                        <span class="token punctuation">[</span><span class="token operator">||</span><span class="token operator">||</span>|                         <span class="token punctuation">]</span> <span class="token number">74.426</span> MB

 ● oc<span class="token operator">-</span>server                           <span class="token punctuation">[</span>                              <span class="token punctuation">]</span> <span class="token number">0</span> <span class="token operator">%</span>
<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>fork_mode<span class="token punctuation">]</span>                        <span class="token punctuation">[</span><span class="token operator">||</span><span class="token operator">||</span>                          <span class="token punctuation">]</span> <span class="token number">57.801</span> MB

 ● pm2<span class="token operator">-</span>http<span class="token operator">-</span><span class="token keyword">interface</span>                  <span class="token punctuation">[</span>                              <span class="token punctuation">]</span> stopped
<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>fork_mode<span class="token punctuation">]</span>                        <span class="token punctuation">[</span>                              <span class="token punctuation">]</span> <span class="token number">0</span> B

 ● start<span class="token operator">-</span>production
<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>fork_mode<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="内存使用超过上限自动重启"><a href="#内存使用超过上限自动重启" class="header-anchor">#</a> 内存使用超过上限自动重启</h2> <p>如果想要你的应用，在超过使用内存上限后自动重启，那么可以加上<code>--max-memory-restart</code>参数。（有对应的配置项）</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>pm2 start big<span class="token operator">-</span>array<span class="token punctuation">.</span>js <span class="token operator">--</span>max<span class="token operator">-</span>memory<span class="token operator">-</span>restart <span class="token number">20</span>M
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="常用命令一览"><a href="#常用命令一览" class="header-anchor">#</a> 常用命令一览</h3> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code><span class="token comment"># 普通 General</span>
$ npm install pm2 <span class="token operator">-</span>g            <span class="token comment"># 安装 PM2</span>
$ pm2 start app<span class="token punctuation">.</span>js              <span class="token comment"># 启动，守护进程，自动重启应用程序 Start, Daemonize and auto-restart application (Node)</span>
$ pm2 start app<span class="token punctuation">.</span>py              <span class="token comment"># 启动，守护进程，自动重启python应用程序 Start, Daemonize and auto-restart application (Python)</span>
$ pm2 start npm <span class="token operator">-</span><span class="token operator">-</span> start        <span class="token comment"># 启动，守护进程，自动重启node应用程序 Start, Daemonize and auto-restart Node application</span>

<span class="token comment"># 集群模式 (只支持node进程) Cluster Mode (Node.js only)</span>
$ pm2 start app<span class="token punctuation">.</span>js <span class="token operator">-</span>i <span class="token number">4</span>         <span class="token comment"># 在集群模式下，启动4个应用程序实例  Start 4 instances of application in cluster mode</span>
                                <span class="token comment"># 同时，将网络请求，负载均衡到每个应用实例  it will load balance network queries to each app</span>
$ pm2 reload all                <span class="token comment"># 0秒重启所有应用 Zero Second Downtime Reload</span>
$ pm2 scale <span class="token punctuation">[</span>app<span class="token operator">-</span>name<span class="token punctuation">]</span> <span class="token number">10</span>       <span class="token comment"># 将应用进程调整到10 Scale Cluster app to 10 process</span>

<span class="token comment"># 进程监控 Scale Cluster app to 10 process</span>
$ pm2 list                      <span class="token comment"># 列出所有用PM2启动的进程 List all processes started with PM2</span>
$ pm2 monit                     <span class="token comment"># 显示每个应用占用的cpu和内存 Display memory and cpu usage of each app</span>
$ pm2 show <span class="token punctuation">[</span>app<span class="token operator">-</span>name<span class="token punctuation">]</span>           <span class="token comment"># 显示某个进程的所有信息 Show all informations about application</span>

<span class="token comment"># 日志管理 Log management</span>
$ pm2 logs                      <span class="token comment"># 显示所有应用的日志  Display logs of all apps</span>
$ pm2 logs <span class="token punctuation">[</span>app<span class="token operator">-</span>name<span class="token punctuation">]</span>           <span class="token comment"># 显示某个应用的日志 Display logs for a specific app</span>
$ pm2 logs <span class="token operator">-</span><span class="token operator">-</span>json               <span class="token comment"># json化日志 Logs in JSON format</span>
$ pm2 flush
$ pm2 reloadLogs

<span class="token comment"># 进程状态管理 Process State Management</span>
$ pm2 start app<span class="token punctuation">.</span>js <span class="token operator">-</span><span class="token operator">-</span>name<span class="token operator">=</span><span class="token string-literal"><span class="token string">&quot;api&quot;</span></span> <span class="token comment"># 启动一个应用并命名为api。 Start application and name it &quot;api&quot;</span>
$ pm2 start app<span class="token punctuation">.</span>js <span class="token operator">-</span><span class="token operator">-</span> <span class="token operator">-</span>a <span class="token number">34</span>     <span class="token comment"># 启动一个应用，并传递“-a 34”的参数。 Start app and pass option &quot;-a 34&quot; as argument</span>
$ pm2 start app<span class="token punctuation">.</span>js <span class="token operator">-</span><span class="token operator">-</span>watch      <span class="token comment"># 重启一个应用，当文件改变的时候。Restart application on file change</span>
$ pm2 start script<span class="token punctuation">.</span>sh           <span class="token comment"># 启动一个bash脚本。Start bash script</span>
$ pm2 start app<span class="token punctuation">.</span>json            <span class="token comment"># 启动在app.json中声明的所有应用。Start all applications declared in app.json</span>
$ pm2 reset <span class="token punctuation">[</span>app<span class="token operator">-</span>name<span class="token punctuation">]</span>          <span class="token comment"># 重置所有计数器。Reset all counters</span>
$ pm2 stop all                  <span class="token comment"># 停止所有应用。Stop all apps</span>
$ pm2 stop <span class="token number">0</span>                    <span class="token comment"># 停止id 为0的应用。Stop process with id 0</span>
$ pm2 restart all               <span class="token comment"># 重启所有应用。Restart all apps</span>
$ pm2 gracefulReload all        <span class="token comment"># 在集群模式下，平稳的重加载所有应用。Graceful reload all apps in cluster mode</span>
$ pm2 delete all                <span class="token comment"># 杀掉所有应用。Kill and delete all apps</span>
$ pm2 delete <span class="token number">0</span>                  <span class="token comment"># 杀掉id为0的进程。Delete app with id 0</span>

<span class="token comment"># 启动／引导管理 Startup/Boot management</span>
$ pm2 startup                   <span class="token comment"># 检测init系统，在启动时生成和配置pm2。Detect init system, generate and configure pm2 boot on startup</span>
$ pm2 save                      <span class="token comment"># 保存当前进程列表。Save current process list</span>
$ pm2 resurrect                 <span class="token comment"># 恢复以前保存的进程。Restore previously save processes</span>
$ pm2 unstartup                 <span class="token comment"># 停用和删除启动系统。Disable and remove startup system</span>
$ pm2 update                    <span class="token comment"># 保存进程，终止PM2并恢复进程。Save processes, kill PM2 and restore processes</span>
$ pm2 generate                  <span class="token comment"># 生成样本json配置文件。Generate a sample json configuration file</span>

<span class="token comment"># 部署 Deployment</span>
$ pm2 deploy app<span class="token punctuation">.</span>json prod setup    <span class="token comment"># 设置“生产环境”远程服务器。 Setup &quot;prod&quot; remote server</span>
$ pm2 deploy app<span class="token punctuation">.</span>json prod          <span class="token comment"># 更新“生产环境”远程服务器。 Update &quot;prod&quot; remote server</span>
$ pm2 deploy app<span class="token punctuation">.</span>json prod revert <span class="token number">2</span> <span class="token comment"># 将“生产环境”远程服务器恢复2。Revert &quot;prod&quot; remote server by 2</span>

<span class="token comment"># 模块系统 Module system</span>
$ pm2 <span class="token keyword">module</span><span class="token symbol">:generate</span> <span class="token punctuation">[</span>name<span class="token punctuation">]</span>    <span class="token comment"># 生成名称为[name]的示例模块。Generate sample module with name [name]</span>
$ pm2 install pm2<span class="token operator">-</span>logrotate     <span class="token comment"># 安装模块（这里是日志循环系统）。Install module (here a log rotation system)</span>
$ pm2 uninstall pm2<span class="token operator">-</span>logrotate   <span class="token comment"># 卸载模块。Uninstall module</span>
$ pm2 publish                   <span class="token comment"># 增量版本，git push和npm发布。Increment version, git push and npm publish</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br></div></div><h3 id="进程管理"><a href="#进程管理" class="header-anchor">#</a> 进程管理</h3> <p>列出正在运行的应用程序</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code>$ pm2 list
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>很简单的管理你的应用进程</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ pm2 stop     <span class="token operator">&lt;</span>app_name<span class="token operator">|</span>id<span class="token operator">|</span><span class="token string-literal"><span class="token string">'all'</span></span><span class="token operator">|</span>json_conf<span class="token operator">&gt;</span>
$ pm2 restart  <span class="token operator">&lt;</span>app_name<span class="token operator">|</span>id<span class="token operator">|</span><span class="token string-literal"><span class="token string">'all'</span></span><span class="token operator">|</span>json_conf<span class="token operator">&gt;</span>
$ pm2 delete   <span class="token operator">&lt;</span>app_name<span class="token operator">|</span>id<span class="token operator">|</span><span class="token string-literal"><span class="token string">'all'</span></span><span class="token operator">|</span>json_conf<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="cpu-进程监控"><a href="#cpu-进程监控" class="header-anchor">#</a> CPU/进程监控</h3> <p>监控所有启动的进程：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ pm2 monit
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="日志设施"><a href="#日志设施" class="header-anchor">#</a> 日志设施</h3> <p>实时显示指定进程或所有进程的日志。提供标准，原始，JSON 和格式输出。</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ pm2 logs <span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'all'</span></span><span class="token operator">|</span>app_name<span class="token operator">|</span>app_id<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>json<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>format<span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token operator">-</span>raw<span class="token punctuation">]</span>`
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>例子:</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ pm2 logs <span class="token constant">APP</span><span class="token operator">-</span><span class="token constant">NAME</span>       <span class="token comment"># Display APP-NAME logs</span>
$ pm2 logs <span class="token operator">-</span><span class="token operator">-</span>json         <span class="token comment"># JSON output</span>
$ pm2 logs <span class="token operator">-</span><span class="token operator">-</span>format       <span class="token comment"># Formated output</span>

$ pm2 flush               <span class="token comment"># Flush all logs</span>
$ pm2 reloadLogs          <span class="token comment"># Reload all logs</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="生成启动脚本"><a href="#生成启动脚本" class="header-anchor">#</a> 生成启动脚本</h3> <div class="language-php line-numbers-mode"><pre class="language-php"><code><span class="token comment">/* PM2可以生成和配置启动脚本，以在每次服务器重新启动时保持PM2和您的进程活动。
支持init系统，如：systemd（Ubuntu 16，CentOS，Arch），upstart（Ubuntu 14/12），launchd（MacOSx，Darwin），rc.d（FreeBSD）。
自动检测init系统+在服务器启动时生成和设置PM2引导。 Auto detect init system + generate and setup PM2 boot at server startup */</span>
$ pm2 startup

<span class="token comment"># 手动指定启动系统. Manually specify the startup system</span>
<span class="token comment"># 可以是：systemd，upstart，launchd，rcd。</span>
$ pm2 startup <span class="token punctuation">[</span>platform<span class="token punctuation">]</span>

<span class="token comment"># 在服务器启动时禁用和删除PM2引导。Disable and remove PM2 boot at server startup</span>
$ pm2 unstartup
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>在重新启动时保存/冻结进程列表：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ pm2 save
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="模块系统-module-system"><a href="#模块系统-module-system" class="header-anchor">#</a> 模块系统 Module system</h2> <p>PM2 嵌入了一个简单而强大的模块系统。安装模块很简单：</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code>$ pm2 install <span class="token operator">&lt;</span>module_name<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/08/21, 14:10:51</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/wwblog/pages/4fff19/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Mysql</div></a> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/wwblog/pages/4fff19/" class="prev">Mysql</a></span> <!----></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="https://github.com/MX-lbw" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://www.jianshu.com/u/b5796d21ef29" title="jianshu" target="_blank" class="iconfont icon-jianshu"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2024
    <span>Wu wei | MIT License</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><!----><div></div><!----></div></div>
    <script src="/wwblog/assets/js/app.0e0201b5.js" defer></script><script src="/wwblog/assets/js/3.e40f20a1.js" defer></script><script src="/wwblog/assets/js/1.6112db0e.js" defer></script><script src="/wwblog/assets/js/115.2eabd80f.js" defer></script><script src="/wwblog/assets/js/25.f1c8b165.js" defer></script><script src="/wwblog/assets/js/26.8d4e2030.js" defer></script>
  </body>
</html>
